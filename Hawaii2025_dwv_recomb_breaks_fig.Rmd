---
title: "Hawaii2025_dwv_recomb_breaks_fig"
author: "Laura"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Project

Here I am exploring the data from Oxford Nanopore seq data from pooled bee samples collected from Hawaii in 2024/2025, we are looking at the viral lanscape, particularly DWV in Hawaii 15 years after our first study.

Here i am making a figure to visualise the variety of recombinants identified by the coverage data



### install packages

```{r, warning=FALSE}

#library(rtracklayer) # for extracting features from gff file
library(dplyr)
library(ggplot2)
#install.packages("gggenes")
library(gggenes)

```



First, the genome.
Actually, this is not v useful, the breakpoints for the actual genes aren't here, only the CDS but that actually looks wrong, so instead manually make a dataframe with the info

```{r}
# Import the GFF
#gff <- import("./DWV_genomic.gff")

#gff_df <- as.data.frame(gff)

# See what the columns look like
#colnames(gff_df)

# Filter only relevant gene features
#gff_df <- as.data.frame(gff) %>%
 # filter(type == "type") %>%
#  select(seqnames, start, end, ID, type = type) %>%
#  mutate(molecule = "Parental")

# 


```


bring in mrecombinants csv

```{r}

recombinant_df <- read.csv("recomb_breakpoints.csv")


```



set colours

```{r}

colours <- c(
  "5'_UTR" = "white",
  "Lp" = "#D9913D",
  "VP3" = "#EDAE49",
  "VP4" = "#FFE2AD",
  "VP1" = "#A5691F",
  "VP2" = "#C47F2E",
  "unk1" = "#F4C166",
  "Hel" = "#4BB0A3",
  "unk2" = "#A3D9D1", 
  "VPg" = "#14564D",
  "3C_pro__RdRp" = "#70C4B7",
  "3'_UTR" = "white",
  "DWV_A" = "#d62828",
  "DWV_B" = "#064789"
)
  
 

```





```{r}


recombinant_df$genome <- factor(recombinant_df$genome, levels = rev(c("DWV_A", "DE1", "GA1")))

plot1 <- ggplot(recombinant_df, aes(xmin = start, xmax = end, y = genome, fill = fill_col, label = label)) +
  geom_gene_arrow(
    arrowhead_height = unit(0, "cm"),
    arrowhead_width = unit(0, "cm"),
    arrow_body_height = unit(0.4, "cm")
  ) +
  geom_gene_label(align = "left") +
  scale_y_discrete(expand = expansion(mult = c(0.05, 0.05))) +  # Reduce space above/below
  theme_minimal() +
  scale_fill_manual(values = colours) +
  labs(title = NULL, x = "nucleotide position", y = "") +
  theme(
    legend.position = "none",
    plot.margin = margin(t = 5, r = 5, b = 5, l = 5),          # Tighter overall margins
    panel.spacing.y = unit(0.1, "lines")                      # Reduce vertical padding
  ) 

plot1




```

 

```{r}



```




```{r}



```





```{r}



```





```{r}



```


